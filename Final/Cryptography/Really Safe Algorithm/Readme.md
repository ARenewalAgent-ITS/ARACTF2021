# Really Safe Algorithm
---
## Deskripsi
I hope getStrongPrime function make this algorithm safe 
## Solusi
Script diatas melakukan enkripsi terhadap string flag , pertama dilakukan generate constant yang mana nilai konstanta tersebut di enkrip dengan fungsi perkalian terhadap nilai random dan modulo , dan terakhir di shift right left. Nilai konstanta tersebut digunakan pada variable f dengan perhitungan d*(p-const) . Langkah untuk melakukan decrypt adalah pertama kita harus tahu nilai konstantanya , algoritma yang dipakai sebenarnya merupakan Hidden Number Problem jadi kita dapat menemukan nilai konstantanya berdasarkan prime,xxx,dan zzz dengan lattice attack. Selanjutnya untuk nilai p dan q dapat ditemukan dengan teori berikut

```
Pertama kita definisikan dulu persamaan yang diketahui
f = d * (p-const)
ef = ed * (p-const)
2^f ≡ 2^(d(p−const)) mod p

2^(ed) ≡ 2^(k*(p−1)*(q−1)+1) ≡ 2 mod p

2^(ef) ≡ 2^(ed*(p−const)) ≡ 2^(p−const) mod p

2^(ef+const-1) ≡ 2p−1 ≡ 1 mod p

2^(ef+const-1) - 1 ≡ kp

dan kita bisa mendapat p dengan melakukan gcd 2^(ef+const-1)-1 dengan N

```
Berikut solver yang digunakan
```
import ast
from Crypto.Util.number import *

c = 502200962496699190898473344071838323675171431035000023005402692584490409483762925811231018257564915508766854533330571637542748087511938250351992170576946411027545518842313541151395855070672819668196658816604549906898578753778113216062503221811929452971945561332085890628488682366509040295136227356179353995786739710650378610960837559832363753974615277279045562275563811303826782059170816004105340415215097301322215904951694878168391848998702543235059797489173146747930033800183678261523208252932976127473907774991785802177006145895037212544480052853848827111078745944655458582308744515520505149170454433449418120722667371181318290388557865165019999532260553392066199158578540748337244123265238311546698360469395879443457172672968512184775348420725746685160539208250066732725954762140698371386864265330410456233172246651938434173827086780425891306234495082739209238265534749268328565655958225179065019156507290673265252989619244151045743863661437967870051575243821010289899339618336479739870280341072467021508187507803700223832442178385744100666811638952457968498967700706154735371817089845107912204004259313705053155799703048904378176970168268715094807116947930130085820453500441055522241483991589178375969901825175950872463535304822

N = 601368171334448440880899399045709214875101220424947184821705708971567332683916374772703970469821964780111274627336752311311211945944796257826025383596755401438223734663455445613346999318116541584850260497963665747136495548490843968916438155705694701902564601512330398659080505779351942662592206684246523594438489189661265908829188316548869597272897673177691051175038498679952720433076766812325256662410903397784237675970083899641196217008583238959032787432411106671519135978002420468300793143005681886443423605715228560638541812610882715318754963344276280149751288193428663226034260264218646170831537075577667802765173887157167359213865349846357298821351633839302535482074252280753988255528295460017036011338627310552306924701240466609817410868775062820550658782105000972559632929620390332819279953451001283685890239704012844702812048868223962786349956618807988014433873300129710749306896100586022020961688320223673931284538431491135727458077548530629058853243740683802113746361976026864565002474179460185320642057782210153572334372303001170338291337721641818109689322349015202238689078370339902363012187752461334455063294515831789898302015657425083742424158263861253458479135054429557868358182126961720924913625737383310619886702067

f = 13649521187992598320234170450353768382677390015876674710449005574670134156696621058017235959180638472664149802595784696541143207342262300893511557942714751773570235043000811362606756683484657414918952477727409787446603571188383499139224327705383417087388658191999442511139049441343188091942829821824771752234303066505533926513834194932543339556113593999102593234957800590799182381955956847787202027837239728812190048834351300736207438741910365038031373359196372246256825403015245378351513457222510680526263817734461538908911099885942493062619294923277818969343667682494905606823557354769860579367773283851339047532639343683969890920335218151904170038610441225406854860712409621522969299641052795416807332914676878561649907711515660543140559050354864781356917028266517150908061925473638612960007518769206281348719911880492246764812196819016170290282573984761749149448504289842926637784402417621225119689349313688966334612398693127133293891538816684300205281050049095611037213031544929339232477054071296684254808173350781418338545226279499899944327587540537345931156674381088452052325744331404066454419547908528137539342143997190686805777871799997463089230325799872971872425414468030194191113649682979156395043952057909997252838745629849609865059989406051017928350688920655903674333300901757607121875365385670521243839301483946829225386283720377921659297272889214872316235657534613849214959188825665458060063422763859812264102003166610817178946566648200306020008374683224957803408863523961666276575949244179502109982506923786555847668115824203751332360142339864311979650050756154089665665017954024340815251281655591931539144186229721486321997620274027624631465559163654254816329677659912383205323670276400727033365602621817704905547806213621439735955796683310401572371309638546981106051407758946102486362302636988245745479850122343448728785351251691686

prime = 9843850041048962668871019046691743696739466921395563806853268577218404412654866360181200131462322751023961718913340500867810418864067521625831312299818273

xxx = [289299097384052042128311133689415145166553650396176287836357619449064272180433564984733953487416361501169987935094698048728413248163851060261378186391782, 2077618500948755862770556584339218043879234976342974496882562229231031846028200422186109214000593238141817882876381466673069163554253300296760372405556064, 7366240077190257950510392883385306757057074595331754360602087481397771633544923883941926974091445220438862871492531877915780784278713708796633856138428814, 1010713469294549290603032013376280346178252762853522619965734837541584319335477470819987697990699037596998129175355829712608951363278086930070958420059037, 2956184239931310899961444921706349398218311036104863631171345038244142049831113548541482029451094078874774798968923258847171037369058315207252709237064131, 7187876885909814636729646753328089020730062243981282553199357118415301034607446530546462970294197144786543569412999374871424402230179607626801344661961794, 4733589267379701984009137993005861312640710249057605328195813935934380660164675479544028770780542075282568861063922634064354933222789493823143398588124136, 1854755840384888399451509690310874511581577905870554797331460342746094214699435253087418141798705505742394728297443854322515386965043416235122537829693509, 144584169249221361509892254228092460956210497941163190934864990673419465884954303012007371212945639021337026231091455201607966355157601275037952275300141, 3598741475197390235158077114923529743632969789821861122671844556502402536409046768012845473288694355058575075110356190872186305542309144493774672025145782]

zzz = [3848570150317713043252083814677201753698950233629654382418918563364455990842516699660444202631734847559651112002345186483861772510742937154185629859315712, 2227122823770578877570629518285778187435865952405714730984030098420391822686257578837585575773289043850915572215197776839539804496411767836495689294020608, 5007482143914948511873171275971494694097121508801491653145124859495959568276589681337459704193596356664492716664821593306720004574354152643744937495494656, 4378306287261284010523132405040411872848088749028514590948724561284722749297963321801933681714933600762304463795992211156526117461915312826849755702231040, 5148689063244143171639406354677278769964519228638602206697977440179606255684491860686278584393907620229495721783308773018081156016891278794830499083714560, 3924889968823777406552032047049852231740216535117731553497808792634084622924340606582308879131304987868188846839460811763364133081557912003553693800595456, 240017433826826359388753509966491370414624181912195973310889793099759310256889995126907062279119436909975426071721389427388185712337100681170431957270528, 2256336173543237607765608873349071296472531186646415314148693378578340531536674485395943282204127681781452933650983596536488582088740223795143895043538944, 3532328994061038265716565700544436745329618012769295405149916238231696821079298092587198567757594480980656976287263961367245760919570890597784575167954944, 5324522214628445046352344423929312891140933883048489386715370079850027890080664226064246737700690806335654548760868548960142166419442325164645465328713728]

e = 65537

n = len(xxx)
k = 360

M = matrix(ZZ, n+2, n+2)
M.set_block(0, 0, prime * matrix.identity(n))
M.set_block(n, 0, matrix(ZZ, 1, n, xxx))
M.set_block(n+1, 0, matrix(ZZ, 1, n, zzz))
M[n,n] = 1
M[n+1,n+1] = 2^k

B = M.LLL()
const = int(abs(B[0][n]))
kp = pow(2,e*f+const-1,N)-1
p = gcd(kp,N)

assert N % p == 0
p = ZZ(p)
q = N//p
phin = (p-1)*(q-1)
d = inverse(e, phin)
m = pow(c, d, N)
print(long_to_bytes(m).decode()[:38])

```
#### ara2021{R4nd000m_S3cur3_4lg0r1thM?!?!}
